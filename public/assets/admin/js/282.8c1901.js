"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[282],{74067:(e,t,r)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(s=a.key,n=void 0,n=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!==o(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(s,"string"),"symbol"===o(n)?n:String(n)),a)}var s,n}r.d(t,{D:()=>s});var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errors={}}var t,r,o;return t=e,(r=[{key:"has",value:function(e){return this.errors.hasOwnProperty(e)}},{key:"any",value:function(){return Object.keys(this.errors).length>0}},{key:"get",value:function(e){if(this.errors[e])return this.errors[e][0]}},{key:"getFlash",value:function(e){if(this.errors[e])return this.errors[e]}},{key:"record",value:function(e){this.errors=e}},{key:"clear",value:function(e){e?this.has(e)&&delete this.errors[e]:this.errors={}}}])&&a(t.prototype,r),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},77282:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var o=r(74067),a=r(20629),s=r(30135);function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===n(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c={data:function(){return{showPasswordModal:!1,passwordForm:{password:"",password_confirmation:""},form:{name:"",email:"",telegram_id:"",tg_first_name:"",tg_last_name:"",tg_username:"",referral_percent:"",referral_token:"",referral_url:"",total_referrals:"",company_name:"",balance:0,phone:"",token:""},errors:new o.D}},computed:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},(0,a.Se)(["userId"])),methods:{checkRole:function(e){if(e&&e instanceof Array&&e.length>0){var t=s.Z.getters&&s.Z.getters.roles,r=e;return t.some((function(e){return r.includes(e)}))}return console.error("Need roles! Like v-role=\"['admin','editor']\""),!1},changePassword:function(){var e=this;axios.post("/api/admin/user/"+this.userId+"/change-password",this.passwordForm).then((function(t){e.$message({message:t.data,type:"success"}),e.showPasswordModal=!1,e.passwordForm.password="",e.passwordForm.password_confirmation=""})).catch((function(t){e.errors.record(t.response.data.errors)}))},onSubmit:function(){var e=this;axios.post("/api/admin/user/"+this.userId+"/update",this.form).then((function(t){e.$store.commit("user/SET_NAME",t.data.name),e.$message({message:"Ваши данные изменены",type:"success"})})).catch((function(t){e.errors.record(t.response.data.errors)}))},getUser:function(){var e=this;axios.get("/api/admin/user/"+this.userId+"/show").then((function(t){e.form=t.data,e.form.referral_url="https://t.me/TOP_testbot?start="+e.form.referral_token}))}},mounted:function(){this.getUser()}};var m=r(51900);const u={components:{userInformation:(0,m.Z)(c,(function(){var e=this,t=e._self._c;return t("section",[t("el-form",{staticClass:"disabled-form",attrs:{model:e.form,"label-position":"top",disabled:!e.checkRole(["admin"])}},[t("div",{staticClass:"row"},[t("el-form-item",{staticClass:"col-md-6",attrs:{label:"Имя",error:e.errors.get("name")}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),t("el-form-item",{staticClass:"col-md-6",attrs:{label:"Баланс"}},[t("el-input",{model:{value:e.form.balance,callback:function(t){e.$set(e.form,"balance",t)},expression:"form.balance"}},[t("template",{slot:"append"},[e._v("руб.")])],2)],1)],1),e._v(" "),t("div",{staticClass:"row"},[t("el-form-item",{staticClass:"col-md-6",attrs:{label:"Telegram"}},[t("el-input",{model:{value:e.form.tg_username,callback:function(t){e.$set(e.form,"tg_username",t)},expression:"form.tg_username"}},[t("template",{slot:"prepend"},[e._v("@")])],2)],1),e._v(" "),t("el-form-item",{staticClass:"col-md-6",attrs:{label:"Telegram ID"}},[t("el-input",{model:{value:e.form.telegram_id,callback:function(t){e.$set(e.form,"telegram_id",t)},expression:"form.telegram_id"}})],1)],1),e._v(" "),t("div",{staticClass:"row"},[t("el-form-item",{staticClass:"col-md-6",attrs:{label:"Telegram Имя"}},[t("el-input",{model:{value:e.form.tg_first_name,callback:function(t){e.$set(e.form,"tg_first_name",t)},expression:"form.tg_first_name"}})],1),e._v(" "),t("el-form-item",{staticClass:"col-md-6",attrs:{label:"Telegram Фамилия"}},[t("el-input",{model:{value:e.form.tg_last_name,callback:function(t){e.$set(e.form,"tg_last_name",t)},expression:"form.tg_last_name"}})],1)],1),e._v(" "),t("div",{staticClass:"row"},[t("el-form-item",{staticClass:"col-md-8",attrs:{label:"Токен"}},[t("el-input",{model:{value:e.form.token,callback:function(t){e.$set(e.form,"token",t)},expression:"form.token"}})],1)],1),e._v(" "),t("div",{staticClass:"row"},[t("el-form-item",{staticClass:"col-md-2",attrs:{label:"Реф. %"}},[t("el-input",{model:{value:e.form.referral_percent,callback:function(t){e.$set(e.form,"referral_percent",t)},expression:"form.referral_percent"}})],1),e._v(" "),t("el-form-item",{staticClass:"col-md-3",attrs:{label:"Приглашено рефералов"}},[t("el-input",{model:{value:e.form.total_referrals,callback:function(t){e.$set(e.form,"total_referrals",t)},expression:"form.total_referrals"}})],1),e._v(" "),e.form.referral_url?t("el-form-item",{staticClass:"col-md-7",attrs:{label:"Ваша реф. ссылка"}},[t("el-input",{model:{value:e.form.referral_url,callback:function(t){e.$set(e.form,"referral_url",t)},expression:"form.referral_url"}})],1):e._e()],1),e._v(" "),t("div",{staticClass:"row align-items-end"},[e.checkRole(["admin"])?t("el-form-item",{staticClass:"col-md-6",attrs:{label:"Телефон"}},[t("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1):e._e(),e._v(" "),e.checkRole(["admin"])?t("el-form-item",{staticClass:"col-md-6",attrs:{label:"Название компании"}},[t("el-input",{model:{value:e.form.company_name,callback:function(t){e.$set(e.form,"company_name",t)},expression:"form.company_name"}})],1):e._e(),e._v(" "),e.checkRole(["admin"])?t("div",{staticClass:"col-md-6",staticStyle:{"margin-bottom":"22px"}},[t("el-button",{attrs:{icon:"el-icon-unlock",type:"primary"},on:{click:function(t){e.showPasswordModal=!0}}},[e._v("Сменить пароль")])],1):e._e()],1),e._v(" "),e.checkRole(["admin"])?t("el-button",{attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("Сохранить")]):e._e()],1),e._v(" "),t("el-dialog",{attrs:{visible:e.showPasswordModal,title:"Сменить пароль"},on:{"update:visible":function(t){e.showPasswordModal=t}}},[t("el-form",{attrs:{model:e.passwordForm,"label-position":"top"}},[t("div",{staticClass:"row"},[t("el-form-item",{staticClass:"col-md-6",attrs:{label:"Новый пароль",error:e.errors.get("password")}},[t("el-input",{attrs:{"show-password":""},model:{value:e.passwordForm.password,callback:function(t){e.$set(e.passwordForm,"password",t)},expression:"passwordForm.password"}})],1),e._v(" "),t("el-form-item",{staticClass:"col-md-6",attrs:{label:"Подтверждение пароля"}},[t("el-input",{attrs:{"show-password":""},model:{value:e.passwordForm.password_confirmation,callback:function(t){e.$set(e.passwordForm,"password_confirmation",t)},expression:"passwordForm.password_confirmation"}})],1)],1)]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.showPasswordModal=!1}}},[e._v("Отмена")]),e._v(" "),t("el-button",{attrs:{type:"success"},on:{click:e.changePassword}},[e._v("Сохранить")])],1)],1)],1)}),[],!1,null,null,null).exports},data:function(){return{activeName:"main-information"}},watch:{activeName:function(e){this.$router.push("".concat(this.$route.path,"?tab=").concat(e))}},created:function(){var e=this.$route.query.tab;e&&(this.activeName=e)}};const f=(0,m.Z)(u,(function(){var e=this,t=e._self._c;return t("section",[t("h1",{staticClass:"page-title"},[e._v("Профиль пользователя")]),e._v(" "),t("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{name:"main-information"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-user"}),e._v(" Основная информация")]),e._v(" "),t("user-information")],1)],1)],1)}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=282.8c1901.js.map